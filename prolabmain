#include <allegro.h>
#include<stdio.h>
#include <string>
#include <string.h> 

#define BLACK makecol(0, 0, 0)
#define WHITE makecol(255, 255, 255)

using namespace std;

string  edittext;                         // an empty string for editting
string	tarih,yolcu,ad,soyad,ad_s,soyad_s;
string::iterator iter = edittext.begin(); // string iterator
int     caret  = 0;                       // tracks the text caret
bool    insert = true;                    // true of should text be inserted
int active_tbox=0;
bool oku_b=false;

FILE *dosya;
char filename[15]="seyahat.txt";
FILE *dosya_k;
char d_adi[15]="otobus.txt";
int eleman_sayisi=0,l=0,m=60,counter=0,o,p,tb=0;
char koltuk[40];

void sefer(BITMAP *,int,int);
void koltuk_oku(BITMAP *);
void txbox(BITMAP *,int);
void Baslat();
void Bitir();
 
struct otobus{
    char tarih[15],nn[20],seferkodu[10],fiyat[10];
}oto;
struct bilet{
    char ad[15],soyad[15],sefer[10],cns[10],tarih[10];
	int kisi;
}bil;

int main() {
Baslat();
int cinsiyet=2,menu=5,k,knum=0,r,ksec=0,x=120,y=110,z=500,comb=0,tkx=0,tky=500;
char s;
char bos[15],cns[10],er[10]="erkek",ba[10]="bayan",nereden[12],nereye[12],koc[12]="kocaeli",man[12]="manisa",bur[12]="bursa",bal[12]="balikesir",izm[12]="izmir";


	BITMAP *tk1=create_bitmap(200,30);
    BITMAP *arakatman=create_bitmap(960,540);
    BITMAP *arakatman2=create_bitmap(760,480);
    BITMAP *arakatman3=create_bitmap(263,480);
	BITMAP *ckatman=create_bitmap(300,44);
    BITMAP *b1=load_bitmap("yeni.bmp",NULL);
    BITMAP *b2=load_bitmap("sef.bmp",NULL);
    BITMAP *b3=load_bitmap("sorg.bmp",NULL);
    BITMAP *bck=load_bitmap("bck.bmp",NULL);
    BITMAP *ext=load_bitmap("ext.bmp",NULL);
    BITMAP *b1h=load_bitmap("yenih.bmp",NULL);
    BITMAP *b2h=load_bitmap("sefh.bmp",NULL);
    BITMAP *b3h=load_bitmap("sorgh.bmp",NULL);
    BITMAP *ttl=load_bitmap("title.bmp",NULL);
	BITMAP *ttl1=load_bitmap("title1.bmp",NULL);
    BITMAP *sttl=load_bitmap("stitle.bmp",NULL);
    BITMAP *sfttl=load_bitmap("sftitle.bmp",NULL);
    BITMAP *e=load_bitmap("e.bmp",NULL);
    BITMAP *b=load_bitmap("b.bmp",NULL);
    BITMAP *eh=load_bitmap("eh.bmp",NULL);
    BITMAP *bh=load_bitmap("bh.bmp",NULL);
    BITMAP *oto=load_bitmap("otobus.bmp",NULL);
    BITMAP *srgl=load_bitmap("srgl.bmp",NULL);
    BITMAP *ke=load_bitmap("ke.bmp",NULL);
    BITMAP *kb=load_bitmap("kb.bmp",NULL);
	BITMAP *p=load_bitmap("p.bmp",NULL);
	BITMAP *snr=load_bitmap("snr.bmp",NULL);
	BITMAP *ony=load_bitmap("ony.bmp",NULL);
	BITMAP *blt=load_bitmap("blt.bmp",NULL);
	BITMAP *uyari=load_bitmap("uyari.bmp",NULL);
	BITMAP *uyari2=load_bitmap("uyari2.bmp",NULL);
	BITMAP *combo=load_bitmap("combo.bmp",NULL);
	BITMAP *tbox=load_bitmap("tbox.bmp",NULL);
	BITMAP *cbox=load_bitmap("cbox.bmp",NULL);
	BITMAP *cboxc=load_bitmap("cboxc.bmp",NULL);
	BITMAP *son=load_bitmap("son.bmp",NULL);

	FONT *advent = load_font("adventpro.pcx",NULL,NULL);

    show_mouse(screen);

    clear_to_color(arakatman,makecol(29,29,29));
    clear_to_color(arakatman2,makecol(29,29,29)); /*arakatman2 butonlara bastığımızda sadece sağ kısımdaki doldurulan alanın sıfırlanması için */
	clear_to_color(ckatman,makecol(29,29,29));
	clear_to_color(tk1,WHITE);
	clear_to_color(arakatman3,makecol(29,29,29));
	

	while (!key[KEY_ESC]) {
				
				/*textprintf_ex(arakatman , font,0,10,WHITE,-1,dizi.c_str());*/
				
				//blit(p,arakatman,0,0,20,400,50,50); /* olası hata durumunda debug testi için */

				
			    blit(bck,arakatman,0,0,0,0,960,60);
                blit(b1,arakatman,0,0,15,75,85,85);
                blit(b2,arakatman,0,0,15,167,85,85);
                blit(b3,arakatman,0,0,15,258,85,85);
				//koltuk_oku(arakatman2);
				//for(int n=0;n<=38;n++)
				//{
				//	textprintf_ex(arakatman2, font , 0, 200, makecol(255, 255, 255),-1, "%c \n", koltuk[n]);

				//}

                /*kod yazarken mouse kordinatı yardımcısı & koltuk numarası bildirici*/
                textprintf_ex(arakatman, font, 100, 0, makecol(255, 255, 255),-1, "x: %d y: %d", mouse_x,mouse_y);
                textprintf_ex(arakatman, font , 300, 0, makecol(255, 255, 255),-1, "koltuk: %d ", knum);
				textprintf_ex(arakatman, font , 300, 15, makecol(255, 255, 255),-1, "tarih: %s ", tarih);
				textprintf_ex(arakatman, font , 300, 30, makecol(255, 255, 255),-1, "A.tbox: %d ", active_tbox);
				textprintf_ex(arakatman, font , 400, 0, makecol(255, 255, 255),-1, "nereden: %s nereye: %s", nereden,nereye);
				//textprintf_ex(arakatman, font , 300, 15, makecol(255, 255, 255),-1, "cnsyt char %s ", cns);
                //********************mouse tıklamalar********************//
                if(!(mouse_b & 1) && mouse_x>900 && mouse_x<960 && mouse_y>0 && mouse_y<60)
                {
                        blit(ext,arakatman,0,0,895,0,60,60);
                }
                if((mouse_b & 1) && mouse_x>900 && mouse_x<960 && mouse_y>0 && mouse_y<60)
				{
                return 0;
                }
				/*ilk bölüm*/
				if((mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>75 && mouse_y<160)
                {
                        menu=0;
						x=350;
						z=500;
                        clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
						blit(snr,arakatman3,0,0,150,430,85,28); 
                        blit(ttl1,arakatman2,0,0,0,0,120,260);
						blit(tbox,arakatman2,0,0,115,15,200,30);
						blit(combo,arakatman2,0,0,115,70,200,30);
						blit(combo,arakatman2,0,0,115,125,200,30);
						blit(tbox,arakatman2,0,0,115,180,200,30);

                }
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>75 && mouse_y<105 && menu==0)
                {
						tkx=115;
						tky=350;
						active_tbox=1;
				}
				if((mouse_b & 1) && !(mouse_x>310 && mouse_x<510) && menu==0 && active_tbox==true || (mouse_b & 1) && !(mouse_y>75 && mouse_y<105) && menu==0 && active_tbox==true )
                {
						tkx=0;
						tky=300;
						active_tbox=0;
						txbox(tk1,0);
				}
				if(active_tbox==1)
				{
						txbox(tk1,0);
				}
				/*if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>180 && mouse_y<210)
                {
						tkx=115;
						tky=15;
						txbox(tk1);
				}*/
				if(strcmp(nereden,nereye)==0)
				{
					blit(uyari2,arakatman3,0,0,0,100,230,44);
				}
				/*yeni*/
                if(!(mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>75 && mouse_y<160)
                {
                        blit(b1h,arakatman,0,0,15,75,85,86);
                }
				
                if((mouse_b & 1) && mouse_x>845 && mouse_x<930 && mouse_y>490 && mouse_y<518 && menu==0 && strcmp(nereden,nereye)!=0)
                {
                        menu=1;
						x=120;
                        clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
                        blit(ttl,arakatman2,0,0,0,0,120,220);
                        blit(oto,arakatman3,0,0,0,0,263,480);
                        masked_blit(e,ckatman,0,0,0,0,32,44);
                        masked_blit(b,ckatman,0,0,32,0,32,44);
						blit(uyari,ckatman,0,0,90,0,210,44);
						blit(snr,arakatman2,0,0,390,430,85,28); 
						blit(tbox,arakatman2,0,0,115,15,200,30);
						blit(tbox,arakatman2,0,0,115,70,200,30);
						sefer(arakatman2,0,200);

                }
				if((mouse_b & 1) && mouse_x>585 && mouse_x<670 && mouse_y>490 && mouse_y<518 && menu==1)
                {
                        menu=-1;
                        clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
						blit(blt,arakatman2,0,0,0,160,500,281);
						blit(ony,arakatman3,0,0,150,430,85,28); 
						textprintf_ex(arakatman2, advent , 230, 220, makecol(255, 255, 255),-1, "%s --> ", nereden);
						textprintf_ex(arakatman2, advent , 300, 220, makecol(255, 255, 255),-1, " %s", nereye);
						textprintf_ex(arakatman2, advent , 230, 290, makecol(255, 255, 255),-1, "%s ", cns);
						textprintf_ex(arakatman2, advent , 230, 360, makecol(255, 255, 255),-1, "%d ", knum);

                }
				if((mouse_b & 1) && mouse_x>845 && mouse_x<930 && mouse_y>490 && mouse_y<518 && menu==-1)
                {
					/*save_fonksiyonu();*/
					clear_to_color(arakatman2,makecol(29,29,29));
					clear_to_color(ckatman,makecol(29,29,29));
					clear_to_color(arakatman3,makecol(29,29,29));
					blit(son,arakatman2,0,0,100,200,200,50);
				}
				/*if(don==1)
				{
				for(int o=0;0<=100;o++)
				{
						clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
				}
					
				}*/

				///combobox1///
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>130 && mouse_y<160 && menu==0 && comb==0)
                {
					comb=1;
					menu=0;
					for(int c=0;c <= 150;c++)
					{
						blit(cboxc,arakatman2,0,0,115,100,200,c);
					}
					
				}
				/*kocaeli*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>160 && mouse_y<190 && menu==0 && comb==1)
                {
					strcpy( nereden,koc );
					
				}
				/*bursa*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>190 && mouse_y<220 && menu==0 && comb==1)
                {
					strcpy( nereden,bur );
				}
				/*balıkesir*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>220 && mouse_y<250 && menu==0 && comb==1)
                {
					strcpy( nereden,bal );
				}
				/*manisa*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>250 && mouse_y<280 && menu==0 && comb==1)
                {
					strcpy( nereden,man );
				}
				/*izmir*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>280 && mouse_y<310 && menu==0 && comb==1)
                {
					strcpy( nereden,izm );
				}
				if(strcmp(nereden,"kocaeli")==0 && menu==0 || strcmp(nereden,"bursa")==0 && menu==0 || strcmp(nereden,"balikesir")==0 && menu==0 || strcmp(nereden,"manisa")==0 && menu==0 || strcmp(nereden,"izmir")==0 && menu==0)
				{
					textprintf_ex(arakatman2, advent , 130, 75, makecol(0, 0, 0),-1, "%s", nereden);
				}
				if(strcmp(nereye,"kocaeli")==0 && menu==0 || strcmp(nereye,"bursa")==0 && menu==0 || strcmp(nereye,"balikesir")==0 && menu==0 || strcmp(nereye,"manisa")==0 && menu==0 || strcmp(nereye,"izmir")==0 && menu==0)
				{
					textprintf_ex(arakatman2, advent , 130, 130, makecol(0, 0, 0),-1, "%s", nereye);
				}

				/*combobox2*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>180 && mouse_y<210 && menu==0 && comb==0)
                {
					comb=2;
					menu=0;
					for(int c=0;c <= 150;c++)
					{
						blit(cboxc,arakatman2,0,0,115,155,200,c);
					}
					
				}
				/*kocaeli*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>210 && mouse_y<240 && menu==0 && comb==2)
                {
					strcpy( nereye,koc );
				}
				/*bursa*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>240 && mouse_y<270 && menu==0 && comb==2)
                {
					strcpy( nereye,bur );
				}
				/*balıkesir*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>270 && mouse_y<300 && menu==0 && comb==2)
                {
					strcpy( nereye,bal );
				}
				/*manisa*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>300 && mouse_y<330 && menu==0 && comb==2)
                {
					strcpy( nereye,man );
				}
				/*manisa*/
				if((mouse_b & 1) && mouse_x>310 && mouse_x<510 && mouse_y>330 && mouse_y<365 && menu==0 && comb==2)
                {
					strcpy( nereye,izm );
				}
				/*cbox1 kapat*/
				if((mouse_b & 1) && !(mouse_x>310 && mouse_x<510) && menu==0 && comb==1|| (mouse_b & 1) && !(mouse_y>130 && mouse_y<160) && menu==0 && comb==1)
                {
						comb=0;
						clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
						blit(snr,arakatman3,0,0,150,430,85,28); 
                        blit(ttl1,arakatman2,0,0,0,0,120,260);
						blit(tbox,arakatman2,0,0,115,15,200,30);
						blit(combo,arakatman2,0,0,115,70,200,30);
						blit(combo,arakatman2,0,0,115,125,200,30);
						blit(tbox,arakatman2,0,0,115,180,200,30);
				}
				/*cbox2 kapat*/
				if((mouse_b & 1) && !(mouse_x>310 && mouse_x<510) && menu==0 && comb==2|| (mouse_b & 1) && !(mouse_y>180 && mouse_y<210) && menu==0 && comb==2)
                {
						comb=0;
						clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
						blit(snr,arakatman3,0,0,150,430,85,28); 
                        blit(ttl1,arakatman2,0,0,0,0,120,260);
						blit(tbox,arakatman2,0,0,115,15,200,30);
						blit(combo,arakatman2,0,0,115,70,200,30);
						blit(combo,arakatman2,0,0,115,125,200,30);
						blit(tbox,arakatman2,0,0,115,180,200,30);
				}
				
				/*seferler*/
                if(!(mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>168 && mouse_y<250)
                {

                        blit(b2h,arakatman,0,0,15,167,85,86);
                }
                if((mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>168 && mouse_y<250)
                {
                        menu=2;
						x=700;
						z=700;
						m=60;
                        clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
                        blit(sfttl,arakatman2,0,0,0,20,120,260);
						sefer(arakatman2,0,0);


                }
				/* sorgula*/
                if(!(mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>258 && mouse_y<328)
                {
                blit(b3h,arakatman,0,0,15,258,85,86);
                }
                if((mouse_b & 1) && mouse_x>15 && mouse_x<100 && mouse_y>258 && mouse_y<328)
                {
                        menu=3;
						x=350;
                        clear_to_color(arakatman2,makecol(29,29,29));
						clear_to_color(ckatman,makecol(29,29,29));
						clear_to_color(arakatman3,makecol(29,29,29));
                        blit(srgl,arakatman2,0,0,0,30,120,260);
						blit(tbox,arakatman2,0,0,115,45,200,30);
						blit(tbox,arakatman2,0,0,115,100,200,30);
                }
				/*cinsiyet*/
                if((mouse_b & 1) && mouse_x>315 && mouse_x<347 && mouse_y>170 && mouse_y<214 && menu==1)
                {
						clear_to_color(ckatman,makecol(29,29,29));
                        masked_blit(eh,ckatman,0,0,0,0,32,44);
                        masked_blit(b,ckatman,0,0,32,0,32,44);
						blit(uyari,ckatman,0,0,90,0,210,44);
                        cinsiyet=1;
						strcpy(cns,er);
                }
                if((mouse_b & 1) && mouse_x>347 && mouse_x<379 && mouse_y>170 && mouse_y<214 && menu==1)
                {
						clear_to_color(ckatman,makecol(29,29,29));
                        masked_blit(bh,ckatman,0,0,32,0,32,44);
                        masked_blit(e,ckatman,0,0,0,0,32,44);
						blit(uyari,ckatman,0,0,90,0,210,44);
                        cinsiyet=0;
						strcpy(cns,ba);
                }
                ///*cisiyet ekrana yazdır sayı*/
                //if(cinsiyet==1)
                //{
                //        textout_ex(arakatman,font,"erkek",250,0,makecol(255,255,255),-1);
                //}
                //if(cinsiyet==0)
                //{
                //        textout_ex(arakatman,font,"bayan",250,0,makecol(255,255,255),-1);
                //}
				/*koltuk secimi algoritması*/
                /* seçim y ekseni koltuk baslangic 120
                         sıra1                 sıra2                 sıra3                 sıra4
                        710<x<750 758<x<798        854<x<894        904<x<944
                                1                        2                        3                        4
                */
                if((mouse_b & 1) && mouse_x>710 && mouse_x<750 && mouse_y>120 && mouse_y<500 && menu==1)
                {
                k=(mouse_y-80)/38;
                knum = 4*(k-1)+1;
                r= 51 + 38*(k-1);
                        /*koltuk bastırma*/
                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,13,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,13,r,38,38);
								ksec=1;
                        }
                }
                if((mouse_b & 1) && mouse_x>758 && mouse_x<798 && mouse_y>120 && mouse_y<500 && menu==1)
                {
                k=(mouse_y-80)/38;
                knum = 4*(k-1)+2;
                r= 51 + 38*(k-1);

                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,62,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,62,r,38,38);
								ksec=1;
                        }
                }
                if((mouse_b & 1) && mouse_x>854 && mouse_x<894 && mouse_y>120 && mouse_y<280 && menu==1)
                {
                k=(mouse_y-80)/38;
                knum = 4*(k-1)+3;
                r= 51 + 38*(k-1);

                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,159,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,159,r,38,38);
								ksec=1;
                        }
                }

                if((mouse_b & 1) && mouse_x>904 && mouse_x<944 && mouse_y>120 && mouse_y<280 && menu==1)
                {
                k=(mouse_y - 80) /38;
                knum = 4*k;
                r= 51 + 38*(k-1);

                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,208,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,208,r,38,38);
								ksec=1;
                        }
                }
                /*orta kapidan sonra*/
                if((mouse_b & 1) && mouse_x>854 && mouse_x<894 && mouse_y>310 && mouse_y<500 && menu==1)
                {
                k=(mouse_y-110)/38;
                knum = 4*(k-1)+3;
				r= 89 + 38*(k-1);

                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,159,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,159,r,38,38);
								ksec=1;
                        }
                }

                if((mouse_b & 1) && mouse_x>904 && mouse_x<944 && mouse_y>310 && mouse_y<500 && menu==1)
                {
                k=(mouse_y - 110) /38;
                knum = 4*k;
				r= 89 + 38*(k-1);

                        if(cinsiyet==1)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(ke,arakatman3,0,0,208,r,38,38);
								ksec=1;
                        }
                        if(cinsiyet==0)
                        {
								if(ksec==1)
								{
									 clear_to_color(arakatman3,makecol(29,29,29));
									 blit(oto,arakatman3,0,0,0,0,263,480);
									 ksec=0;
								}
                                blit(kb,arakatman3,0,0,208,r,38,38);
								ksec=1;
                        }
					
                }
	blit(tk1,arakatman2,0,0,tkx,tky,200,30);
	blit(ckatman,arakatman2,0,0,x,y,300,44);
	blit(arakatman3,arakatman2,0,0,z,0,263,480);
	blit(arakatman2,arakatman,0,0,195,60,760,480);
	blit(arakatman,screen,0,0,0,0,960,540);
	rest(60);
}
Bitir();
return 0;
}
END_OF_MAIN()
 
void Baslat() {
int depth, res;
allegro_init();
depth = desktop_color_depth();
if (depth == 0) depth = 32;
set_color_depth(depth);
res = set_gfx_mode(GFX_AUTODETECT_WINDOWED, 960, 540, 0, 0);
if (res != 0) {
allegro_message(allegro_error);
exit(-1);
}
install_timer();
install_keyboard();
install_mouse();
 
}
void Bitir() {
clear_keybuf();
}
void txbox(BITMAP *arakatman, int a)
{
	if(active_tbox==1)
	{
	while(keypressed())
      {

         int  newkey   = readkey();
         char ASCII    = newkey & 0xff;
         char scancode = newkey >> 8;
		 
		 
				 // hangi karakter tuştan basıldıysa onu stringe ekle
				 if(ASCII >= 32 && ASCII <= 126)
				 {
					// yeni karakter ekleme, yerleştirme yada yenileme için lazım
					if(insert || iter == edittext.end())
					   iter = edittext.insert(iter, ASCII);
					else
					   edittext.replace(caret, 1, 1, ASCII);
 
					//  caret ve iterator ün artırılması
					caret++;
					iter++;
				 }
	     
				// Diğer, "özel" tuşlar basıldığında; yapılacaklar
				 else
					switch(scancode)
					{
					   case KEY_DEL:
						  if(iter != edittext.end()) iter = edittext.erase(iter);
					   break;
 
					   case KEY_BACKSPACE:
						  if(iter != edittext.begin())
						  {
							 caret--;
							 iter--;
							 iter = edittext.erase(iter);
							 eleman_sayisi--;
						  }
					   break;
 
					   case KEY_RIGHT:
						  if(iter != edittext.end())   caret++, iter++;
					   break;
 
					   case KEY_LEFT:
						  if(iter != edittext.begin()) caret--, iter--;
					   break;
 
					   case KEY_INSERT:
						  if(insert) insert = 0; else insert = 1;
					   break;
 
					   default:
 
					   break;
					}
			}
	 clear_to_color(arakatman,makecol(255,255,255)); 
	 vline(arakatman, caret * 8, 8, 18, BLACK);
	 textprintf_ex(arakatman , font,0,10,BLACK,-1,edittext.c_str());
	 if(a==0)
	 {
		tarih=edittext.c_str();
	 }
	 if(a==1)
	 {
		yolcu=edittext.c_str();
	 }
	 if(a==2)
	 {
		ad=edittext.c_str();
	 }
	 if(a==3)
	 {
		soyad=edittext.c_str();
	 }
	 if(a==4)
	 {
		ad_s=edittext.c_str();
	 }
	 if(a==5)
	 {
		soyad_s=edittext.c_str();
	 }

		 //textout(arakatman, font, dizi, 0, 10, WHITE);  /// ONEMLİ
				
		 }
	
}

void sefer(BITMAP *arakatman,int o,int p)
{
		dosya=fopen(filename,"r+");

		if(dosya==NULL)
		{
    		textout_ex(arakatman,font,"Sefer bulunamadı",0,0,makecol(255,255,255),-1);
      		exit(1);
		}
		char ch;
		ch=fgetc(dosya);
		while(ch!=EOF)
		{
			if(ch!=42)
			{
			textprintf_ex(arakatman, font, l+o, m+p, makecol(255, 255, 255),-1, "%c", ch);
			}
    		ch=fgetc(dosya);
    		fflush(stdin);
			l+=7;
			counter++;
			if(ch==42)
			{
				l=0;
				m+=20;
				counter=0;
			}
		}
		fclose(dosya);
}

void koltuk_oku(BITMAP *arakatman)
{
	int a=0;
	char b;
	dosya_k=fopen(d_adi,"r+");
		if(oku_b==false)	//sürekli okumayı durdurmak için
		{
			char ch;
			ch=fgetc(dosya_k);
			while(ch!=42)
			{
				textprintf_ex(arakatman, font, l, m, makecol(255, 255, 255),-1, "%c", ch);
				koltuk[a]=ch;
				a++;
    			ch=fgetc(dosya_k);
    			fflush(stdin);
				l+=8;
				oku_b=true;

			}
			l=0;
		}

	fclose(dosya_k);
}
